(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],[,,,,function(e,t,n){e.exports=n(11)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(3),c=n.n(o),s=(n(9),n(1)),i=(n(10),function(e){var t=e.onLogin,n=e.setError,o=Object(r.useState)(""),c=Object(s.a)(o,2),i=c[0],u=c[1];return Object(r.useEffect)((function(){n("")}),[]),a.a.createElement("div",{className:"login"},a.a.createElement("div",{className:"auth"},a.a.createElement("input",{className:"form-control",onChange:function(e){return u(e.target.value)},placeholder:"Enter Username Here"}),a.a.createElement("button",{className:"btn btn-login",onClick:function(){var e;(e=i,fetch("/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}).catch((function(){return Promise.reject({error:"Network Error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))).then((function(e){t(e)})).catch((function(e){n(e.error)}))}},"Login")))}),u=function(e){var t=e.onSend,n=e.setError,o=e.setUserState,c=Object(r.useState)(""),i=Object(s.a)(c,2),u=i[0],l=i[1];return a.a.createElement("div",{className:"message"},a.a.createElement("textarea",{rows:"5",cols:"50",className:"form-control text-message",value:u,onChange:function(e){n(""),l(e.target.value)},placeholder:"Enter Message Here"}),a.a.createElement("button",{className:"btn btn-send",onClick:function(e){(function(e){return fetch("/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}).catch((function(){return Promise.reject({error:"Network Error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))})(u).then((function(e){t(e),l("")})).catch((function(e){n(e.error),"Unauthorized user"!==e.error&&"User not allowed"!==e.error||o({isLoggedIn:!1})}))}},"Send Message"))},l=function(e){var t=e.users,n=e.messages,r=Object.values(t).map((function(e){return a.a.createElement("li",{className:"item-group-child",key:e.name.toString()},a.a.createElement("span",{className:"user-name"},e.name))})),o=Object.values(n).map((function(e){return a.a.createElement("li",{className:"item-group-child chat-message",key:e.uId+e.timestamp},a.a.createElement("div",{className:"item-grid"},a.a.createElement("div",{className:"user-info"},a.a.createElement("span",{className:"info-success"},e.user.name),a.a.createElement("span",{className:"info-danger"},e.timestamp)),a.a.createElement("span",{className:"user-message"},e.message)))}));return a.a.createElement("div",{className:"chat-area"},a.a.createElement("div",null,a.a.createElement("center",null,a.a.createElement("b",null,"Users")),a.a.createElement("ul",{className:"item-group"},r)),a.a.createElement("div",null,a.a.createElement("center",null,a.a.createElement("b",null,"Messages")),a.a.createElement("ul",{className:"item-group chat-group"},o)))},m=function(e){var t=e.onLogout,n=e.setError;return a.a.createElement("div",{className:"logout"},a.a.createElement("button",{className:"btn btn-logout",onClick:function(){fetch("/session",{method:"DELETE"}).catch((function(){return Promise.reject({error:"Network Error"})})).then((function(e){if(!e.ok)return Promise.reject({error:"Error logging out the user"})})).then((function(){return t()})).catch((function(e){n(e.error)}))}},"Logout"))},f=function(e){var t=e.setUserState,n=e.setError,o=Object(r.useState)([]),c=Object(s.a)(o,2),i=c[0],f=c[1],h=Object(r.useState)([]),E=Object(s.a)(h,2),g=E[0],d=E[1],j=function(){fetch("/users",{method:"GET"}).catch((function(){return Promise.reject({error:"Network Error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){f(e)})).catch((function(e){n(e.error)}))},p=function(){fetch("/messages",{method:"GET"}).catch((function(){return Promise.reject({error:"Network Error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){d(e)})).catch((function(e){n(e.error)}))};return Object(r.useEffect)((function(){j(),p(),n("")}),[]),a.a.createElement("div",{className:"chat"},a.a.createElement(m,{onLogout:function(){t({isLoggedIn:!1})},setError:n}),a.a.createElement("div",{className:"message-area"},a.a.createElement(u,{onSend:function(e){d(e)},setError:n,setUserState:t})),a.a.createElement(l,{users:i,messages:g}))},h=function(){var e=Object(r.useState)({isLoggedIn:!1}),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(""),u=Object(s.a)(c,2),l=u[0],m=u[1];Object(r.useEffect)((function(){fetch("/session",{method:"GET"}).catch((function(e){return Promise.reject({error:"Network Error"})})).then((function(e){if(!e.ok)return Promise.reject({error:"Invalid Login"})})).then((function(e){o({isLoggedIn:!0,username:e})}))}),[]);return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("h2",null,"Welcome To OurChat!")),a.a.createElement("section",null,a.a.createElement("p",{className:"info-danger"},l),n.isLoggedIn&&a.a.createElement(f,{setUserState:o,setError:m}),!n.isLoggedIn&&a.a.createElement(i,{onLogin:function(e){o({isLoggedIn:!0,username:e})},setError:m})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[4,1,2]]]);
//# sourceMappingURL=main.b726291a.chunk.js.map